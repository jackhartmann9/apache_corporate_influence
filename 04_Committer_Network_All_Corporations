SELECT a.organization_name as Source, b.organization_name as Target, count(a.project_name) as weight
FROM test.apache_committers_updated a
INNER JOIN test.apache_committers_updated b ON a.project_name=b.project_name
WHERE a.datasource_id = 70910 AND b.datasource_id = 70910 AND a.project_name <> 'incubator' AND a.project_name not LIKE '%PMC' AND b.organization_name <> '' AND a.organization_name <> '' 
AND a.svn_id != b.svn_id
AND a.organization_name <> b.organization_name
AND a.organization_name < b.organization_name
AND a.svn_id < b.svn_id
AND a.organization_name <> ASF
AND b.organization_name <> ASF
GROUP BY 1,2
HAVING weight > 50
ORDER BY 3 DESC





SELECT a.organization_name as Org1, b.organization_name as Org2
FROM apache_committers a
INNER JOIN apache_committers b on a.project_name=b.project_name
AND a.project_name <> 'incubator'
AND a.project_name NOT LIKE '%pmc'
AND b.project_name <> 'incubator'
AND b.project_name NOT LIKE '%pmc'
Order BY 1



SELECT a.organization as Org1, b.organization as Org2, count(a.committer_id)
FROM 
	(SELECT c.committer_id, c.organization, d.project_id
	FROM apache_committers c
	INNER JOIN apache_committer_projects d on c.committer_id = c.committer_id
	WHERE c.organization is not null) a
INNER JOIN 
	(SELECT c.committer_id, c.organization, d.project_id
	FROM apache_committers c
	INNER JOIN apache_committer_projects d on c.committer_id = c.committer_id
	WHERE c.organization is not null) b
    on a.project_id=b.project_id
Group by 1
