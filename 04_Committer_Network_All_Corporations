SELECT a.organization_name as Source, b.organization_name as Target, count(a.project_name) as weight
FROM test.apache_committers_updated a
INNER JOIN test.apache_committers_updated b ON a.project_name=b.project_name
WHERE a.datasource_id = 70910 AND b.datasource_id = 70910 AND a.project_name <> 'incubator' AND a.project_name not LIKE '%PMC' AND b.organization_name <> '' AND a.organization_name <> '' 
AND a.svn_id != b.svn_id
AND a.organization_name <> b.organization_name
AND a.organization_name < b.organization_name
AND a.svn_id < b.svn_id
AND a.organization_name <> ASF
AND b.organization_name <> ASF
GROUP BY 1,2
HAVING weight > 50
ORDER BY 3 DESC
